<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-atom.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.png?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.4.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="网络七层协议应用层、表达层、会话层、传输层、网络层、数据链路层、物理层。 如何让你设计网络物理层 - 集线器数据链路层 - 交换机，维护 端口 - MAC 地址表网络层 - 路由器，对比源 IP 和目标 IP 子网掩码，不同则走默认路由 TCP 协议TCP 重传：TCP 重传机制包括：1、超时重传，2、快速重传，3、SACK，4、D-SACK。超时重传：数据发送时，设定一个定时器，当超过指定时间，">
<meta name="keywords" content="http,面试">
<meta property="og:type" content="article">
<meta property="og:title" content="inter-http">
<meta property="og:url" content="https://wuwhs.gitee.io/2021/10/18/inter-http/index.html">
<meta property="og:site_name" content="wuwh&#39;s blog">
<meta property="og:description" content="网络七层协议应用层、表达层、会话层、传输层、网络层、数据链路层、物理层。 如何让你设计网络物理层 - 集线器数据链路层 - 交换机，维护 端口 - MAC 地址表网络层 - 路由器，对比源 IP 和目标 IP 子网掩码，不同则走默认路由 TCP 协议TCP 重传：TCP 重传机制包括：1、超时重传，2、快速重传，3、SACK，4、D-SACK。超时重传：数据发送时，设定一个定时器，当超过指定时间，">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2022-09-27T03:58:43.964Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="inter-http">
<meta name="twitter:description" content="网络七层协议应用层、表达层、会话层、传输层、网络层、数据链路层、物理层。 如何让你设计网络物理层 - 集线器数据链路层 - 交换机，维护 端口 - MAC 地址表网络层 - 路由器，对比源 IP 和目标 IP 子网掩码，不同则走默认路由 TCP 协议TCP 重传：TCP 重传机制包括：1、超时重传，2、快速重传，3、SACK，4、D-SACK。超时重传：数据发送时，设定一个定时器，当超过指定时间，">






  <link rel="canonical" href="https://wuwhs.gitee.io/2021/10/18/inter-http/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>inter-http | wuwh's blog</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?fa314f7747528620032d3194b7fccc9a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">wuwh's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Make progress every day</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签<span class="badge">37</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类<span class="badge">12</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档<span class="badge">70</span></a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wuwhs.gitee.io/2021/10/18/inter-http/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wuwhs">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wuwh's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">inter-http
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-10-18 20:19:06" itemprop="dateCreated datePublished" datetime="2021-10-18T20:19:06+08:00">2021-10-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2022-09-27 11:58:43" itemprop="dateModified" datetime="2022-09-27T11:58:43+08:00">2022-09-27</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/面试/" itemprop="url" rel="index"><span itemprop="name">面试</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="网络七层协议"><a href="#网络七层协议" class="headerlink" title="网络七层协议"></a>网络七层协议</h3><p>应用层、表达层、会话层、传输层、网络层、数据链路层、物理层。</p>
<p><a href="https://mp.weixin.qq.com/s/jiPMUk6zUdOY6eKxAjNDbQ" target="_blank" rel="noopener">如何让你设计网络</a><br>物理层 - 集线器<br>数据链路层 - 交换机，维护 端口 - MAC 地址表<br>网络层 - 路由器，对比源 IP 和目标 IP 子网掩码，不同则走默认路由</p>
<h3 id="TCP-协议"><a href="#TCP-协议" class="headerlink" title="TCP 协议"></a>TCP 协议</h3><p>TCP 重传：<br>TCP 重传机制包括：1、超时重传，2、快速重传，3、SACK，4、D-SACK。<br>超时重传：数据发送时，设定一个定时器，当超过指定时间，没有收到对方的 ack 确认应答报文，就会重发该数据。超时重传时间 RTO 应该略大于往返时延 RTT（数据发送到接受确认的时刻的差值）。<br>快速重传：收到三个相同的 ack 报文时，会在定时器过期之前，重传丢失的报文段。<br>SACK：TCP 头部 SACK 字段，缓存地图发送给发送方，知道发送方那些数据收到了，哪些没有收到。<br>D-SACk：使用 SACK 告诉发送方哪些数据被重复接收了。</p>
<p><a href="https://xiaolincoding.com/network/3_tcp/tcp_feature.html" target="_blank" rel="noopener">TCP 重传、窗口滑动、流量控制和拥塞控制</a></p>
<p><a href="https://mp.weixin.qq.com/s/t_YOxIrY6EZwnoU2KrgMdA" target="_blank" rel="noopener">没想到 TCP 居然还有这种打开方式</a></p>
<p>传输层 - UDP，增加源端口号和目标端口号</p>
<p>TCP 窗口流量控制：</p>
<ul>
<li>A -&gt; B 发送 TCP 消息会带上 win，win 是窗口大小，表示 A 的接受能力，B 收到后会回复 ack 和 win，表示 B 的接收能力；</li>
<li>如果两个 win 大小相同，A 每收到一个 ack 后窗口整体移动一步；</li>
<li>如果长度不同，B 发给 A 的 win 变大，证明 B 的接受能力变强，A 的窗口上边界往右边移动，扩大发送窗口；</li>
<li>B 发给 A 的 win 变小，证明 B 的接受能力变弱，A 的窗口上边界不动，等接受到 ack 后下边界右移即可，窗口大小变为 win 的长度，再整体移动；</li>
<li>win 值是通过试探算出来的，比如第一次发送 2 个，第二次发送 3 个…；</li>
</ul>
<h3 id="TCP-协议三次握手"><a href="#TCP-协议三次握手" class="headerlink" title="TCP 协议三次握手"></a>TCP 协议三次握手</h3><p>1、第一次握手：刚开始客户端处于 CLOSED 的状态，服务端处于 LISTEN 状态。客户端给服务端发一个 SYN 报文，并指明客户端的初始化序列号 ISN。此时客户端处于 SYN_SEND 状态。<br>2、第二次握手：服务器收到客户端的 SYN 报文之后，会以自己的 SYN 报文作为应答，并且也是指定了自己的初始化序列号 ISN，同时会把客户端的 ISN + 1 作为 ACK 的值，表示自己已经收到了客户端的 SYN，此时服务器处于 SYN_REVD 的状态。<br>3、第三次握手：客户端收到 SYN 报文之后，会发送一个 ACK 报文，当然，也是一样把服务器的 ISN + 1 作为 ACK 的值，表示已经收到了服务端的 SYN 报文，此时客户端处于 ESTABLELISHED 状态。<br>4、服务器收到 ACK 报文之后，也处于 ESTABLELISHED 状态，此时，双方以建立起了链接。</p>
<h3 id="为什么是-3-次？"><a href="#为什么是-3-次？" class="headerlink" title="为什么是 3 次？"></a>为什么是 3 次？</h3><p>避免历史连接，确认客户端发来的请求是这次通信的人。</p>
<h3 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h3><p>1、第一次挥手：在挥手之前服务端与客户端都处于 ESTABLISTEN 状态。客户端发送一个 FIN 报文，报文中会指定一个序列号。此时客户端处于 FIN_WAIT1 状态。<br>2、第二次挥手：服务端收到 FIN 之后，会发送 ACK 报文，且把客户端的序列号值 + 1 作为 ACK 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 CLOSE_WAIT 状态。<br>3、第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，发给 FIN 报文，且指定一个序列号。此时服务端处于 LAST_ACK 的状态。<br>4、第四次挥手：客户端收到 FIN 之后，一样发送一个 ACK 报文作为应答，且把服务端的序列号值 + 1 作为自己 ACK 报文的序列号值，此时客户端处于 TIME_WAIT 状态。需要过一阵子以确保服务端收到自己的 ACK 报文之后才会进入 CLOSED 状态<br>5、服务端收到 ACK 报文之后，就处于关闭连接了，处于 CLOSED 状态。</p>
<p>参考：<a href="https://juejin.cn/post/6978733203062915103" target="_blank" rel="noopener">关于三次握手和四次挥手，面试官想听到怎样的回答？</a></p>
<h3 id="HTTP-1-0-HTTP1-1-HTTP2-0-版本之间的差异"><a href="#HTTP-1-0-HTTP1-1-HTTP2-0-版本之间的差异" class="headerlink" title="HTTP/1.0 HTTP1.1 HTTP2.0 版本之间的差异"></a>HTTP/1.0 HTTP1.1 HTTP2.0 版本之间的差异</h3><h4 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP 0.9"></a>HTTP 0.9</h4><ul>
<li>1991 年,原型版本，功能简陋，只有一个命令 GET,只支持纯文本内容，该版本已过时。</li>
</ul>
<h4 id="HTTP1-0"><a href="#HTTP1-0" class="headerlink" title="HTTP1.0"></a>HTTP1.0</h4><ul>
<li>任何格式的内容都可以发送，这使得互联网不仅可以传输文字，还能传输图像、视频、二进制等文件。</li>
<li>除了 GET 命令，还引入了 POST 命令和 HEAD 命令。</li>
<li>http 请求和回应的格式改变，除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据。</li>
<li>只使用 header 中的 If-Modified-Since 和 Expires 作为缓存失效的标准。</li>
<li>不支持断点续传，也就是说，每次都会传送全部的页面和数据。</li>
<li>通常每台计算机只能绑定一个 IP，所以请求消息中的 URL 并没有传递主机名（hostname）</li>
</ul>
<h4 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP 1.1"></a>HTTP 1.1</h4><p>http1.1 是目前最为主流的 http 协议版本，从 1999 年发布至今，仍是主流的 http 协议版本。</p>
<ul>
<li>引入了持久连接（ persistent connection），即 TCP 连接默认不关闭，可以被多个请求复用，不用声明 Connection: keep-alive。长连接的连接时长可以通过请求头中的 keep-alive 来设置。</li>
<li>引入了管道机制（ pipelining），即在同一个 TCP 连接里，客户端可以同时发送多个请求，进一步改进了 HTTP 协议的效率。</li>
<li>HTTP 1.1 中新增加了 E-tag，If-Unmodified-Since, If-Match, If-None-Match 等缓存控制标头来控制缓存失效。</li>
<li>支持断点续传，通过使用请求头中的 Range 来实现。</li>
<li>使用了虚拟网络，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个 IP 地址。</li>
<li>新增方法：PUT、 PATCH、 OPTIONS、 DELETE。</li>
</ul>
<h4 id="http1-x-版本问题"><a href="#http1-x-版本问题" class="headerlink" title="http1.x 版本问题"></a>http1.x 版本问题</h4><ul>
<li>在传输数据过程中，所有内容都是明文，客户端和服务器端都无法验证对方的身份，无法保证数据的安全性。</li>
<li>HTTP/1.1 版本默认允许复用 TCP 连接，但是在同一个 TCP 连接里，所有数据通信是按次序进行的，服务器通常在处理完一个回应后，才会继续去处理下一个，这样子就会造成队头阻塞。</li>
<li>http/1.x 版本支持 Keep-alive，用此方案来弥补创建多次连接产生的延迟，但是同样会给服务器带来压力，并且的话，对于单文件被不断请求的服务，Keep-alive 会极大影响性能，因为它在文件被请求之后还保持了不必要的连接很长时间。</li>
</ul>
<h4 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP 2.0"></a>HTTP 2.0</h4><ul>
<li>二进制分帧。这是一次彻底的二进制协议，头信息和数据体都是二进制，并且统称为”帧”：头信息帧和数据帧。</li>
<li>头部压缩。HTTP 1.1 版本会出现 「User-Agent、Cookie、Accept、Server、Range」 等字段可能会占用几百甚至几千字节，而 Body 却经常只有几十字节，所以导致头部偏重。HTTP 2.0 使用 HPACK 算法进行压缩。</li>
<li>多路复用。复用 TCP 连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，且不用按顺序一一对应，这样子解决了队头阻塞的问题。</li>
<li>服务器推送。允许服务器未经请求，主动向客户端发送资源，即服务器推送。</li>
<li>请求优先级。可以设置数据帧的优先级，让服务端先处理重要资源，优化用户体验。</li>
</ul>
<h3 id="谈一谈你对-HTTP-2-理解"><a href="#谈一谈你对-HTTP-2-理解" class="headerlink" title="谈一谈你对 HTTP/2 理解"></a>谈一谈你对 HTTP/2 理解</h3><h4 id="头部压缩"><a href="#头部压缩" class="headerlink" title="头部压缩"></a>头部压缩</h4><p>HTTP1.1 版本出现 「User-Agent、Cookie、Accept、Server、Range」 等字段可能会占用几百甚至几千字节，而 Body 却经常只有几十字节，所以导致头部偏重。<br>HTTP2.0 使用 HPACK 算法进行压缩。「传索引」的方式，可以说让请求头字段得到极大程度的精简和复用。其次是对于整数和字符串进行「哈夫曼编码」，哈夫曼编码的原理就是先将所有出现的字符建立一张索引表，然后让出现次数多的字符对应的索引尽可能短，传输的时候也是传输这样的「索引序列」，可以达到非常高的压缩率。</p>
<h4 id="多路复用"><a href="#多路复用" class="headerlink" title="多路复用"></a>多路复用</h4><p>HTTP1.x 中，如果想并发多个请求，必须使用多个 TCP 链接，且浏览器为了控制资源，还会对单个域名又 6-8 个的 TCP 链接请求限制。</p>
<p>HTTP2 中：</p>
<ul>
<li>同域名下所有通信都在单个连接上完成。</li>
<li>单个连接可以承载任意数量的双向数据流。</li>
<li>数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装，也就是 Stream ID，流标识符，有了它，接收方就能从乱序的二进制帧中选择 ID 相同的帧，按照顺序组装成请求/响应报文。</li>
</ul>
<h4 id="服务器推送"><a href="#服务器推送" class="headerlink" title="服务器推送"></a>服务器推送</h4><p>浏览器发送一个请求，服务器主动向浏览器推送与这个请求相关的资源，这样浏览器就不用发起后续请求。</p>
<p>相比较 HTTP/1.1 的优势</p>
<ul>
<li>推送资源可以由不同页面共享。</li>
<li>服务器可以按照优先级推送资源。</li>
<li>客户端可以缓存推送的资源。</li>
<li>客户端可以拒收推送过来的资源。</li>
</ul>
<h4 id="二进制分帧"><a href="#二进制分帧" class="headerlink" title="二进制分帧"></a>二进制分帧</h4><p>之前是明文传输，不方便计算机解析，对于回车换行符来说到底是内容还是分隔符，都需要内部状态机去识别，这样子效率低，HTTP/2 采用二进制格式，全部传输 01 串，便于机器解码。<br>这样子一个报文格式就被拆分成一个个二进制帧，用「Headers 帧」存放头部字段，「Data 帧」存放请求体数据。这样子的话，就是一堆乱序的二进制帧，它们不存在先后关系，因此不需要排队等待，解决了 HTTP 队头阻塞问题。</p>
<p>在客户端与服务器之间，双方都可以互相发送二进制帧，这样子「双向传输的序列」，称为流，所以 HTTP/2 中以流来表示一个 TCP 连接上进行多个数据帧的通信，这就是多路复用概念。</p>
<p>那乱序的二进制帧，是如何组装成对的报文呢？</p>
<ul>
<li>所谓乱序，值是不同 ID 的 Stream 是乱序的，对于同一个 Stream ID 的帧是按顺序传输的。</li>
<li>接收方收到二进制后，将相同的 Stream ID 组装成完整的请求报文和响应报文。</li>
<li>二进制帧中有一些字段，控制着优先级和流量控制等功能，这样子的话，就可以设置数据帧的优先级，让服务器处理重要资源，优化用户体验。</li>
</ul>
<h3 id="介绍一下-HTTP-常见状态码"><a href="#介绍一下-HTTP-常见状态码" class="headerlink" title="介绍一下 HTTP 常见状态码"></a>介绍一下 HTTP 常见状态码</h3><p>RFC 规定 HTTP 的状态码为「三位数」，第一个数字定义了响应的类别，被分为五类:</p>
<ul>
<li>「1xx」: 代表请求已被接受，需要继续处理。</li>
<li>「2xx」: 表示成功状态。</li>
<li>「3xx」: 重定向状态。</li>
<li>「4xx」: 客户端错误。</li>
<li>「5xx」: 服务器端错误。</li>
</ul>
<h4 id="1xx-信息类"><a href="#1xx-信息类" class="headerlink" title="1xx 信息类"></a>1xx 信息类</h4><p>接受的请求正在处理，信息类状态码。</p>
<h4 id="2xx-成功"><a href="#2xx-成功" class="headerlink" title="2xx 成功"></a>2xx 成功</h4><ul>
<li>200 OK 表示从客户端发来的请求在服务器端被正确请求。</li>
<li>204 No content，表示请求成功，但没有资源可返回。</li>
<li>206 Partial Content，该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的 GET 请求<br>响应报文中包含由 「Content-Range」 指定范围的实体内容。</li>
</ul>
<h4 id="3xx-重定向"><a href="#3xx-重定向" class="headerlink" title="3xx 重定向"></a>3xx 重定向</h4><ul>
<li>301 moved permanently，永久性重定向，表示资源已被分配了新的 URL，这时应该按 Location 首部字段提示的 URI 重新保存。</li>
<li>302 found，临时性重定向，表示资源临时被分配了新的 URL。</li>
<li>303 see other，表示资源存在着另一个 URL，应使用 GET 方法获取资源。</li>
<li>304 not modified，当协商缓存命中时会返回这个状态码。</li>
<li>307 temporary redirect，临时重定向，和 302 含义相同,不会改变 method</li>
</ul>
<h4 id="4XX-客户端错误"><a href="#4XX-客户端错误" class="headerlink" title="4XX 客户端错误"></a>4XX 客户端错误</h4><ul>
<li>400 bad request，请求报文存在语法错误。</li>
<li>401 unauthorized，表示发送的请求需要有通过 HTTP 认证的认证信息。</li>
<li>403 forbidden，表示对请求资源的访问被服务器拒绝。</li>
<li>404 not found，表示在服务器上没有找到请求的资源。</li>
<li>405 Method Not Allowed，服务器禁止使用该方法，客户端可以通过 options 方法来查看服务器允许的访问方法，如下 👇<blockquote>
<p>Access-Control-Allow-Methods →GET,HEAD,PUT,PATCH,POST,DELETE</p>
</blockquote>
</li>
</ul>
<h4 id="5XX-服务器错误"><a href="#5XX-服务器错误" class="headerlink" title="5XX 服务器错误"></a>5XX 服务器错误</h4><ul>
<li>500 internal sever error，表示服务器端在执行请求时发生了错误。</li>
<li>502 Bad Gateway，服务器自身是正常的，访问的时候出了问题，具体啥错误我们不知道。</li>
<li>503 service unavailable，表明服务器暂时处于超负载或正在停机维护，无法处理请求。</li>
</ul>
<p>参考：<a href="https://juejin.cn/post/6857287743966281736" target="_blank" rel="noopener">「查缺补漏」巩固你的 HTTP 知识体系</a></p>
<h3 id="DNS-如何工作的"><a href="#DNS-如何工作的" class="headerlink" title="DNS 如何工作的"></a>DNS 如何工作的</h3><p>DNS 协议提供的是一种主机名到 IP 地址的转换服务，就是我们常说的域名系统。是应用层协议，通常该协议运行在 UDP 协议之上，使用的是 53 端口号。</p>
<p>本地 DNS 服务器查询：递归查询</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">客户端-- &gt; 浏览器缓存-- &gt; 本地的hosts文件-- &gt; 本地DNS解析器缓存-- &gt; 本地DNS服务器</span><br></pre></td></tr></table></figure>
<p>本地 DNS 服务器向其他域名服务器请求的过程：迭代查询</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">本地DNS服务器-- &gt; 根域名服务器</span><br><span class="line">本地DNS服务器-- &gt; 顶级域名服务器</span><br><span class="line">本地DNS服务器-- &gt; 权威域名服务器</span><br></pre></td></tr></table></figure>
<h4 id="递归查询和迭代查询"><a href="#递归查询和迭代查询" class="headerlink" title="递归查询和迭代查询"></a>递归查询和迭代查询</h4><ul>
<li>递归查询指的是查询请求发出后，域名服务器代为向下一级域名服务器发出请求，最后向用户返回查询的最终结果。使用递归查询，用户只需要发出一次查询请求。</li>
<li>迭代查询指的是查询请求后，域名服务器返回单次查询的结果。下一级的查询由用户自己请求。使用迭代查询，用户需要发出多次的查询请求。</li>
</ul>
<p>一般而言，本地服务器查询是递归查询，本地 DNS 服务器向其他域名服务器请求的过程是迭代查询。</p>
<h4 id="DNS-为什么用-UDP-协议作为传输"><a href="#DNS-为什么用-UDP-协议作为传输" class="headerlink" title="DNS 为什么用 UDP 协议作为传输"></a>DNS 为什么用 UDP 协议作为传输</h4><p>DNS 使用 UDP 协议作为传输层协议的主要原因是为了避免使用 TCP 协议造成的连接时延。</p>
<h4 id="Connection-keep-alive"><a href="#Connection-keep-alive" class="headerlink" title="Connection: keep-alive"></a>Connection: keep-alive</h4><p>HTTP 协议采用“请求-应答”模式，当使用普通模式，即非 keep-alive 模式时，每个请求、应答客户和服务器都要新建一个连接，完成之后立即断开连接。<br>当使用 keep-alive 模式时，keep-alive 功能使客户端到服务端的连接持续有效，当出现对服务器的后继请求时，keep-alive 功能避免建立或者重新建立连接。</p>
<h4 id="为什么要使用-keep-alive"><a href="#为什么要使用-keep-alive" class="headerlink" title="为什么要使用 keep-alive"></a>为什么要使用 keep-alive</h4><p>keep-alive 技术的创建目的，能在多次 HTTP 之前重用同一个 TCP 连接，从而减少创建、关闭多个 TCP 连接开销（包括响应时间、CPU 资源，减少拥堵）。</p>
<h4 id="客户端如何开启"><a href="#客户端如何开启" class="headerlink" title="客户端如何开启"></a>客户端如何开启</h4><p>在 HTTP、1.0 协议中，默认是关闭的，需要 http 头加入 <code>Connection: keep-alive</code>，才能启动。http1.1 中默认启动。如果加入 <code>Connection: close</code> 关闭。</p>
<h3 id="HTTP-缓存策略"><a href="#HTTP-缓存策略" class="headerlink" title="HTTP 缓存策略"></a>HTTP 缓存策略</h3><h4 id="强缓存"><a href="#强缓存" class="headerlink" title="强缓存"></a>强缓存</h4><p>强缓存两个相关字段，<code>Expires</code>，<code>Cache-Control</code>。HTTP1.0 版本使用<code>Expires</code>，HTTP1.1 使用 <code>Cache-Control</code>。</p>
<h5 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h5><p>Expires 即过期时间，时间是相对于服务器的时间而言的，存在于服务端返回的响应头中，在这个过期时间之前可以直接从缓存里面获取数据，无需再次请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Expires:Mon, <span class="number">29</span> Jun <span class="number">2020</span> <span class="number">11</span>:<span class="number">10</span>:<span class="number">23</span> GMT</span><br></pre></td></tr></table></figure>
<p>表示该资源在 2020 年 7 月 29 日 11:10:23 过期，过期时就会重新向服务器发起请求。<br>这种方式有一个问题：服务器的时间和浏览器的时间可能并不一致。</p>
<h5 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h5><p>HTTP1.1 版本，使用该字段，这个字段采用的是时间过期时长，对应是 <code>max-age</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cache-Control:max-age=<span class="number">6000</span></span><br></pre></td></tr></table></figure>
<p>上面表示该资源返回后 6000 秒，可以直接使用缓存。</p>
<p>注意：</p>
<ul>
<li>当 Expires 和 Cache-Control 同时存在时，优先考虑 Cache-Control；</li>
<li>当没有命中强缓存，接下来进入协商缓存。</li>
</ul>
<h4 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h4><p>强缓存失效后，浏览器在请求头中携带响应的缓存 tag 来向服务器发送请求，服务器根据对应的 tag，来决定是否使用缓存。</p>
<p>缓存分为两种，<code>Last-Modified</code> 和 <code>ETag</code>。两者各有优势，并不存在谁对谁绝对优势。</p>
<h5 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a>Last-Modified</h5><p>这个字段表示的是最后修改时间。在浏览器第一次给服务器发送请求后，服务器会在响应头中加上这个字段。</p>
<p>浏览器接收后，如果再次请求，会在请求头携带 <code>If-Modified-Since</code> 字段，这个字段的值就是服务器传来的最后修改时间。</p>
<p>服务器拿到请求头中的 <code>If-Modified-Since</code>的字段后，其实会和这个服务器中该资源的最后修改时间对比：</p>
<ul>
<li>如果请求头中的这个值小于最后修改时间，说明是时候更新了。返回新的资源，跟常规请求的流程一样；</li>
<li>否则返回 304，高速浏览器直接使用缓存。</li>
</ul>
<h5 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h5><p><code>ETag</code> 是服务器根据当前文件的内容，对文件生成唯一的标识，只要里面内容有改动，这个值就会修改，服务器通过把响应头将该字段返回给浏览器登录。</p>
<p>浏览器接收到 <code>ETag</code> 值，会在下次请求的时候，将这个值作为 <code>If-None-Match</code> 这个字段的内容，发给服务器。</p>
<p>服务器接收到 <code>If-None-Match</code> 后，会跟服务器上该资源的 ETag 进行对比。</p>
<ul>
<li>如果两者一样的话，直接返回 304，高速浏览器直接使用缓存；</li>
<li>如果不一样的话，说明内容更新了，返回新的资源，跟常规的 HTTP 请求响应的流程一样。</li>
</ul>
<h5 id="两者对比"><a href="#两者对比" class="headerlink" title="两者对比"></a>两者对比</h5><ul>
<li>性能上，<code>Last-Modified</code> 优于 <code>ETag</code>，<code>Last-Modified</code>记录的是时间点，而<code>ETag</code>需要根据文件算法生成对应的 <code>hash</code> 值。</li>
<li>精度上，<code>ETag</code> 优于 <code>Last-Modified</code>。<code>ETag</code> 按照内容给资源带上标识，能准确感知资源变化，<code>Last-Modified</code>在某些场景并不能感知变化。<ul>
<li>编辑了资源文件，但是文件内容并没有更改，这样会造成缓存失效；</li>
<li><code>Last-Modified</code> 能够感知的单位是秒，如果文件在 1s 内改变了多次，那么这个时候的 <code>Last-Modified</code> 并没有体现出修改了。</li>
</ul>
</li>
</ul>
<h4 id="缓存位置"><a href="#缓存位置" class="headerlink" title="缓存位置"></a>缓存位置</h4><p>浏览器缓存的位置，分为四种，优先级从高到低：</p>
<ul>
<li>Service Worker</li>
<li>Memory Cache</li>
<li>Disk Cache</li>
<li>Push Cache</li>
</ul>
<h3 id="HTTP-的请求方法"><a href="#HTTP-的请求方法" class="headerlink" title="HTTP 的请求方法"></a>HTTP 的请求方法</h3><ul>
<li>HTTP1.0 定义了三种请求方法：GET、POST 和 HEAD 方法；</li>
<li>HTTP1.1 新增了五种请求方法：OPITONS、PUT、DELETE、TRACE 和 CONNECT。</li>
</ul>
<p>HTTP1.1 规定一下请求方法</p>
<ul>
<li>GET：请求获取 Request-URI 所标识的资源；</li>
<li>POST：在 Request-URI 所标识的资源后附加新的数据；</li>
<li>HEAD：请求获取由 Request-URI 所标识的资源的响应消息报头；</li>
<li>PUT：请求服务器存储一个资源，并用 Request-URI 作为其标识；</li>
<li>DELETE：请求服务器删除对应所标识的资源；</li>
<li>TRACE：请求服务器回送收到的请求信息，主要用于测试或者诊断；</li>
<li>CONNECT：建立连接隧道，用于代理服务器；</li>
<li>OPTIONS：列出可对资源实行的请求方法，用来跨域请求。</li>
</ul>
<h4 id="GET-和-POST-请求的区别"><a href="#GET-和-POST-请求的区别" class="headerlink" title="GET 和 POST 请求的区别"></a>GET 和 POST 请求的区别</h4><ul>
<li>从缓存角度看，GET 请求后，浏览器会主动缓存，POST 默认情况下不能；</li>
<li>从参数角度看，GET 请求一般放在 URL 中，因此不安全，POST 请求放在请求体中，相对而言较为安全，但是在抓包的情况下都是一样的；</li>
<li>从编码角度看，GET 请求只能 URL 编码，只能接受 ASCII 码，而 POST 支持更多的编码类型且不对数据类型限制；</li>
<li>GET 请求幂等，POST 请求不幂等，幂等指发送 M 和 N 次请求（两者不相同且都大于 1），服务器上资源的状态一致；</li>
<li>GET 请求会一次性发送请求报文，POST 请求通常范围两个 TCP 数据包，首先发 header 部分，如果服务器响应 100（continue），然后发 body 部分；</li>
</ul>
<h4 id="options-方法作用"><a href="#options-方法作用" class="headerlink" title="options 方法作用"></a>options 方法作用</h4><ul>
<li>OPTIONS 请求与 HEAD 类似，一般也是用于客户端查看服务器的性能；</li>
<li>这个方法会请求服务器返回该资源所支持的所有 HTTP 请求方法，该方法会用“*”来代替资源名称，向服务器发送 OPTIONS 请求，可以测试服务器功能是否正常；</li>
<li>JS 的 XMLHttpRequest 对象进行 CORS 跨域资源共享时，对于复杂请求，就会使用 OPTIONS 方法发送嗅探请求，以判断是否对指定资源的访问权限。</li>
</ul>
<h3 id="对头阻塞问题"><a href="#对头阻塞问题" class="headerlink" title="对头阻塞问题"></a>对头阻塞问题</h3><h4 id="什么是队头阻塞"><a href="#什么是队头阻塞" class="headerlink" title="什么是队头阻塞"></a>什么是队头阻塞</h4><p>对于每个 HTTP 请求而言，这些任务是会被放入一个任务队列中串行执行的，一旦队首任务请求太慢时，就会阻塞后面的请求处理，这就是 HTTP 队头阻塞问题。</p>
<h4 id="并发连接"><a href="#并发连接" class="headerlink" title="并发连接"></a>并发连接</h4><p>我们知道对于一个域名而言，是允许分配多个长连接的，那么可以理解成增加了任务队列，也就是说不会导致一个任务阻塞了改任务队列的其他任务，在 RFC 规范中规定客户端最多并发 2 个连接，不过实际情况要更多，比如，Chrome 是 6 个。</p>
<h4 id="域名分片"><a href="#域名分片" class="headerlink" title="域名分片"></a>域名分片</h4><p>顾名思义，我们可以在一个域名下分出两个二级域名，而它们最终指向的还是同一个服务器，这样子的话就可以处理的任务队列更多，解决队头阻塞问题。</p>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><p>浏览器遵循同源策略，协议（scheme）、主机（host）和端口号（port）都相同称为同源。非同源站点有一些限制：</p>
<ul>
<li>不能读取和修改对方的 DOM；</li>
<li>不能访问对方的 Cookie、indexDB 和 localStorage。</li>
</ul>
<p>当浏览器向目标 URI 发 Ajax 请求时，当前 URL 和目标 URL 不同源，则产生跨域，被称为跨域请求。底层原理是由于浏览器将每个渲染进程装进了沙箱，为了防止 CPU 芯片一直存在的 Spectre 和 Meltdown 漏洞，采取了站点隔离手段，给每个不同站点（一级域名不同）分配了沙箱，互补干扰。</p>
<h4 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h4><p>CORS 是 W3C 的一个标准，全称是跨域资源共享。它需要浏览器和服务器的共同支持，在弄清楚 CORS 原理之前，需要知道两个概念：简单请求和非简单请求。</p>
<p>属于如下条件的是简单请求：</p>
<ul>
<li>请求方法为 GET、POST 和 HEAD；</li>
<li>请求头的取值范围：Accept、Accept-Language、Content-Language、Content-Type（只限于三个值 application/x-www-form-urlencoded、multipart/form-data 和 text/plain）。</li>
</ul>
<p>非简单请求主要体现在两个方面：预检请求和响应字段。</p>
<p>预检请求的方法是 OPTIONS，还会加上两个关键字段：</p>
<ul>
<li>Access-Control-Request-Method，列出 CORS 请求用到哪个 HTTP 方法；</li>
<li>Access-Control-Request-Headers，清除 CORS 请求将要加上什么请求头</li>
</ul>
<p>其中有这样几个关键的响应头字段:</p>
<p>Access-Control-Allow-Origin: 表示可以允许请求的源，可以填具体的源名，也可以填*表示允许任意源请求。<br>Access-Control-Allow-Methods: 表示允许的请求方法列表。<br>Access-Control-Allow-Credentials: 简单请求中已经介绍。<br>Access-Control-Allow-Headers: 表示允许发送的请求头字段<br>Access-Control-Max-Age: 预检请求的有效期，在此期间，不用发出另外一条预检请求。</p>
<p>参考 <a href="https://juejin.cn/post/6844904100035821575" target="_blank" rel="noopener">（建议精读）HTTP 灵魂之问，巩固你的 HTTP 知识体系</a></p>

      
    </div>

    
      

  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2018/04/11/HTTP协议总结（整理版）/" rel="bookmark">HTTP协议总结（整理版）</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2018/04/18/HTTP缓存机制/" rel="bookmark">HTTP缓存机制</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2021/10/16/inter-code/" rel="bookmark">前端面试之代码实现</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2018/03/04/inter-css/" rel="bookmark">前端面试之css</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2018/03/05/inter-html/" rel="bookmark">前端面试之html</a></div>
      
    </li>
  
  </ul>


    

    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>wuwhs</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://wuwhs.gitee.io/2021/10/18/inter-http/" title="inter-http">https://wuwhs.gitee.io/2021/10/18/inter-http/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/http/" rel="tag"># http</a>
          
            <a href="/tags/面试/" rel="tag"># 面试</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/10/17/inter-js-pro/" rel="next" title="前端面试之高级javascript">
                <i class="fa fa-chevron-left"></i> 前端面试之高级javascript
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/12/01/style/" rel="prev" title="组员重构代码千奇百怪，直接JS、ES6和Vue规范给一梭子">
                组员重构代码千奇百怪，直接JS、ES6和Vue规范给一梭子 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="wuwhs" />
            
              <p class="site-author-name" itemprop="name">wuwhs</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">70</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">37</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/wuwhs" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://segmentfault.com/u/wuwhs" target="_blank" title="Segmentfault" rel="external nofollow"><i class="fa fa-fw fa-globe"></i>Segmentfault</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#网络七层协议"><span class="nav-number">1.</span> <span class="nav-text">网络七层协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-协议"><span class="nav-number">2.</span> <span class="nav-text">TCP 协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-协议三次握手"><span class="nav-number">3.</span> <span class="nav-text">TCP 协议三次握手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么是-3-次？"><span class="nav-number">4.</span> <span class="nav-text">为什么是 3 次？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四次挥手"><span class="nav-number">5.</span> <span class="nav-text">四次挥手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-1-0-HTTP1-1-HTTP2-0-版本之间的差异"><span class="nav-number">6.</span> <span class="nav-text">HTTP/1.0 HTTP1.1 HTTP2.0 版本之间的差异</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-0-9"><span class="nav-number">6.1.</span> <span class="nav-text">HTTP 0.9</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP1-0"><span class="nav-number">6.2.</span> <span class="nav-text">HTTP1.0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-1-1"><span class="nav-number">6.3.</span> <span class="nav-text">HTTP 1.1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http1-x-版本问题"><span class="nav-number">6.4.</span> <span class="nav-text">http1.x 版本问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-2-0"><span class="nav-number">6.5.</span> <span class="nav-text">HTTP 2.0</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#谈一谈你对-HTTP-2-理解"><span class="nav-number">7.</span> <span class="nav-text">谈一谈你对 HTTP/2 理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#头部压缩"><span class="nav-number">7.1.</span> <span class="nav-text">头部压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多路复用"><span class="nav-number">7.2.</span> <span class="nav-text">多路复用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#服务器推送"><span class="nav-number">7.3.</span> <span class="nav-text">服务器推送</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二进制分帧"><span class="nav-number">7.4.</span> <span class="nav-text">二进制分帧</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍一下-HTTP-常见状态码"><span class="nav-number">8.</span> <span class="nav-text">介绍一下 HTTP 常见状态码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1xx-信息类"><span class="nav-number">8.1.</span> <span class="nav-text">1xx 信息类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2xx-成功"><span class="nav-number">8.2.</span> <span class="nav-text">2xx 成功</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3xx-重定向"><span class="nav-number">8.3.</span> <span class="nav-text">3xx 重定向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4XX-客户端错误"><span class="nav-number">8.4.</span> <span class="nav-text">4XX 客户端错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5XX-服务器错误"><span class="nav-number">8.5.</span> <span class="nav-text">5XX 服务器错误</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS-如何工作的"><span class="nav-number">9.</span> <span class="nav-text">DNS 如何工作的</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#递归查询和迭代查询"><span class="nav-number">9.1.</span> <span class="nav-text">递归查询和迭代查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNS-为什么用-UDP-协议作为传输"><span class="nav-number">9.2.</span> <span class="nav-text">DNS 为什么用 UDP 协议作为传输</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Connection-keep-alive"><span class="nav-number">9.3.</span> <span class="nav-text">Connection: keep-alive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#为什么要使用-keep-alive"><span class="nav-number">9.4.</span> <span class="nav-text">为什么要使用 keep-alive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端如何开启"><span class="nav-number">9.5.</span> <span class="nav-text">客户端如何开启</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-缓存策略"><span class="nav-number">10.</span> <span class="nav-text">HTTP 缓存策略</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#强缓存"><span class="nav-number">10.1.</span> <span class="nav-text">强缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Expires"><span class="nav-number">10.1.1.</span> <span class="nav-text">Expires</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cache-Control"><span class="nav-number">10.1.2.</span> <span class="nav-text">Cache-Control</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#协商缓存"><span class="nav-number">10.2.</span> <span class="nav-text">协商缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Last-Modified"><span class="nav-number">10.2.1.</span> <span class="nav-text">Last-Modified</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ETag"><span class="nav-number">10.2.2.</span> <span class="nav-text">ETag</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#两者对比"><span class="nav-number">10.2.3.</span> <span class="nav-text">两者对比</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#缓存位置"><span class="nav-number">10.3.</span> <span class="nav-text">缓存位置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-的请求方法"><span class="nav-number">11.</span> <span class="nav-text">HTTP 的请求方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GET-和-POST-请求的区别"><span class="nav-number">11.1.</span> <span class="nav-text">GET 和 POST 请求的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#options-方法作用"><span class="nav-number">11.2.</span> <span class="nav-text">options 方法作用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对头阻塞问题"><span class="nav-number">12.</span> <span class="nav-text">对头阻塞问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#什么是队头阻塞"><span class="nav-number">12.1.</span> <span class="nav-text">什么是队头阻塞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#并发连接"><span class="nav-number">12.2.</span> <span class="nav-text">并发连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#域名分片"><span class="nav-number">12.3.</span> <span class="nav-text">域名分片</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#跨域"><span class="nav-number">13.</span> <span class="nav-text">跨域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CORS"><span class="nav-number">13.1.</span> <span class="nav-text">CORS</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">copyright by wuwh's blog</span>

  

  
</div>


  










        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  













  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

  

</body>
</html>
